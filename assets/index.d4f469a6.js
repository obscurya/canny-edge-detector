(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();const I=[.2126,.7152,.0722],O=1,_=5,w=[[1,0,-1],[2,0,-2],[1,0,-1]],H=[[1,2,1],[0,0,0],[-1,-2,-1]],h={EAST:"EAST",SOUTH_EAST:"SOUTH_EAST",SOUTH:"SOUTH",SOUTH_WEST:"SOUTH_WEST",WEST:"WEST"},C={[h.EAST]:[0,Math.PI/8],[h.SOUTH_EAST]:[Math.PI/8,Math.PI/8*3],[h.SOUTH]:[Math.PI/8*3,Math.PI/8*5],[h.SOUTH_WEST]:[Math.PI/8*5,Math.PI/8*7],[h.WEST]:[Math.PI/8*7,Math.PI]},U=30,b=70,L=(n,r)=>Math.sqrt(n**2+r**2),A=(n,r)=>{const s=r/4;return{x:s%n.width,y:Math.floor(s/n.width)}},f=n=>{const r=n.length,s=n[0].length,e=new ImageData(new Uint8ClampedArray(s*r*4),s,r);for(let t=0;t<e.data.length;t+=4){const{x:o,y:c}=A(e,t);for(let i=0;i<3;i++){const l=t+i;e.data[l]=Math.abs(n[c][o])}e.data[t+3]=255}return e},S=n=>[...new Array(n.length)].map((r,s)=>[...new Array(n[0].length)].map((e,t)=>n[s][t])),P=(n,r)=>[...new Array(r)].map(()=>[...new Array(n)].map(()=>0)),D=(n,r)=>{const[s,e,t]=r,o=P(n.width,n.height);for(let c=0;c<n.data.length;c+=4){const{x:i,y:l}=A(n,c),u=n.data[c]*s+n.data[c+1]*e+n.data[c+2]*t;o[l][i]=u}return o},R=(n,r,s)=>{const e=2*s**2;return 1/(Math.PI*e)*Math.exp(-(n**2+r**2)/e)},v=(n,r)=>{const s=Math.floor(n/2);return[...new Array(n)].map((e,t)=>{const o=t-s;return[...new Array(n)].map((c,i)=>{const l=i-s;return R(l,o,r)})})},m=(n,r,s,e)=>{var t,o;return(o=(t=n[s])==null?void 0:t[r])!=null?o:e},E=(n,r)=>{const s=S(n),e=Math.floor(r.length/2);for(let t=0;t<n.length;t++)for(let o=0;o<n[0].length;o++){n[t][o]=0;for(let c=0;c<r.length;c++){const i=c-e,l=t+i;for(let u=0;u<r[0].length;u++){const a=u-e,g=o+a,T=m(s,g,l,s[t][o])*r[c][u];n[t][o]+=T}}}return n},x=(n,r,s)=>{E(n,v(r,s))},N=n=>{const[r,s]=[...new Array(2)].map(()=>S(n));E(r,w),E(s,H);const e=[...new Array(n.length)].map(()=>[...new Array(n[0].length)]);for(let t=0;t<n.length;t++)for(let o=0;o<n[0].length;o++){n[t][o]=L(r[t][o],s[t][o]);const i=(()=>{const l=Math.atan2(s[t][o],r[t][o]);return l<0?l+Math.PI:l})();e[t][o]=Object.entries(C).find(([,l])=>i>=l[0]&&i<=l[1])[0]}return{grayscaleMatrix:n,gradientDirections:e}},G=(n,r)=>{const s=S(n);for(let e=0;e<s.length;e++)for(let t=0;t<s[0].length;t++){const o=s[e][t];if(o===0)continue;const c=r[e][t],l=(()=>{switch(c){case h.EAST:case h.WEST:return[{x:t-1,y:e},{x:t+1,y:e}];case h.SOUTH_EAST:return[{x:t-1,y:e-1},{x:t+1,y:e+1}];case h.SOUTH:return[{x:t,y:e-1},{x:t,y:e+1}];case h.SOUTH_WEST:return[{x:t-1,y:e+1},{x:t+1,y:e-1}];default:return[{x:t,y:e},{x:t,y:e}]}})(),[u,a]=l.map(({x:g,y:T})=>m(s,g,T,o));if(o<u||o<a){n[e][t]=0;continue}n[e][t]=o}},W=(n,r,s)=>{for(let e=0;e<n.length;e++)for(let t=0;t<n[0].length;t++){const o=Math.abs(n[e][t]);if(o!==0){if(o<r){n[e][t]=0;continue}if(o<s){n[e][t]=128;continue}n[e][t]=255}}},M=n=>{const r=S(n),s=(e,t)=>{for(let o=0;o<3;o++){const c=o-1,i=t+c;for(let l=0;l<3;l++){const u=l-1,a=e+u;a===e&&i===t||m(r,a,i,r[t][e])!==128||(r[i][a]=255,n[t][e]=255,s(a,i))}}};for(let e=0;e<r.length;e++)for(let t=0;t<r[0].length;t++){if(r[e][t]!==255){n[e][t]=0;continue}s(t,e)}},K=n=>{const s=n.getContext("2d").getImageData(0,0,n.width,n.height),e=[],t=D(s,I);e.push([f(t),"grayscale"]),x(t,_,O),e.push([f(t),"gaussian blur"]);const{grayscaleMatrix:o,gradientDirections:c}=N(t);return e.push([f(o),"sobel operator"]),G(o,c),e.push([f(o),"edge thinning"]),W(o,U,b),e.push([f(o),"double threshold"]),M(o),e.push([f(o),"edge tracking"]),e};const y=document.querySelector(".container"),d=y.querySelector("#source"),k=d.getContext("2d"),p=new Image;p.onload=()=>{d.width=p.width/2,d.height=p.height/2,k.drawImage(p,0,0,d.width,d.height),K(d).forEach(([n,r])=>{const s=document.createElement("div");y.appendChild(s);const e=document.createElement("canvas");e.width=d.width,e.height=d.height,e.getContext("2d").putImageData(n,0,0),s.appendChild(e);const o=document.createElement("span");o.textContent=r,s.appendChild(o)})};p.src="./image.jpg";
